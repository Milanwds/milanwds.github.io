<!DOCTYPE html>
<html lang="fr" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>PassGenerator | Milan WDS | Priv√© üîê</title>
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
    <link rel="manifest" href="favicons/site.webmanifest">
    <link rel="mask-icon" href="favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="style-pass_sanitaire.css">
  </head>
  <body>
    <div>
      <div style="position: relative; float: left;">
        <br><a href="index.html" class="myButton">‚¨Ö Acceuil</a>
      </div><br><br><br>
    <section>
      <br><h2><u>G√©nerer un QR-Code (2D-DOC)</u></h2>
      <h2>(üíâPass Sanitaireüíâ)</h2>
      <br>
      <form>
        <div class="form-group">
          <label for="prenom">Pr√©nom : </label>
          <input type="text" id="prenom"></input> <br>
        </div>
        <div class="form-group">
          <label for="nom">Nom de famille : </label>
          <input type="text" id="nom"></input> <br>
        </div>
        <div class="form-group">
          <label for="dateNaiss">Date de naissance : </label>
          <input type="date" id="dateNaiss"> <br>
        </div>
        <button class="mybutton" type="button" onclick="dataMatrix()">G√©nerer le QR Code</button><br>
         <br>
        <em>Dans le pr√©nom ou dans le nom de famille, il ne faut pas mettre d'accent, ni de trema.. En gros l'√©crire simplement!! Sinon √ßa ne va pas marcher sur l'application TAC</em>
        <br>
        <p>--------------------------------</p>
      </form>
    </section>
    <br>
    <section>
      <h2>üí°√Ä savoirüí°</h2>
      <p>L'ajout de certificat sur l'appli TousAntiCovid ne fonctionne pas pour IOS (la technologie <strong>2D-DOC</strong> n'est plus support√©)</p>
      <p>La date des injections sont fait automatiquement par le code JavaScript, les doses sont automatiquement √† 2 et ensuite le status de vaccination est automatiquement mis en tant que vaccin√©!!</p>
      <p>Le probl√®me du code est la signature du QR-Code (c'est √† dire le 2D-DOC) qui ont uniquement les autorit√© de sant√© la cl√© afin de faire la signature mais apparamment fonctionnel pour l'appli TousAntiCovid!</p>
      <p>--</p>
      <p>¬©2022, Milan WDS</p>
    </section>
  </body>
</html>

<script type="text/javascript">
  async function dataMatrix() {
  	const name = document.getElementById("nom").value;
  	const prename = document.getElementById("prenom").value;
  	const dateNaiss = dateFormat(document.getElementById("dateNaiss").value.replace(/-/g, ""));
    // dosenumber on peut le modifier dans la console!!
  	let dosenumber = 2;
  	let dateInj;
    const dateRandom = Math.floor(Math.random() * 30);
    console.log(dateRandom)
    if (dateRandom > 9) {
      dateInj = dateRandom.toString() + "06" + "2021";
    } else {
      dateInj = "0" + dateRandom.toString() + "06" + "2021";
    }
  	let dataMatrixLink = "http://boy.co.ua/generator.php?s=DC04FR0000011E6D1E6DL101FRL0"+name+"%1DL1"+prename+"%1DL2"+dateNaiss+"L3COVID-19%1DL4J07BX03%1DL5COMIRNATY+PFIZER%2FBIONTECH%1DL6COMIRNATY+PFIZER%2FBIONTECH%1DL7"+dosenumber+"L82L9"+dateInj+"LATE%1F32T2SI2RUMPDLBHAFSBDF2CUE7GI4NR5WC3NSBEU6AZ7QZJZCPMCTXTVIDZAKEYO7237SQ2ZPOCMZKG7U3Q2LIMPPVJMA7TQAAKC5DY&n=c&d=8";
    window.location.href = dataMatrixLink;
  }

  function dateFormat(date){
    const day = date.slice(-2);
    const month = date.slice(4,-2);
  	const year = date.slice(0,-4);
    return day+month+year;
  }
</script>